# This file is automatically generated with Dockerfile.j2 as a template. Do not
# edit by hand, since your changes will be lost!
FROM buildpack-deps AS builder

# Create a shallow clone of the implementation repository in the work directory,
# containing only the code of the specified version/tag.
WORKDIR /wolfssl
RUN git clone --branch v3.6.9d --depth 1 https://github.com/wolfSSL/wolfssl.git .

# Standard compilation
RUN ./autogen.sh
RUN ./configure
RUN make

# Install to a temporary directory
RUN make install DESTDIR=/tmp/package-dir

# Install package to a new container, so we can be sure that we are running
# this specific package.
FROM debian
COPY --from=builder /tmp/package-dir /
RUN ldconfig

# Expose the default port
EXPOSE 4433


# Copy the example key to the container
COPY key.pem cert.pem cacert.pem ./

# Start the server, replace this with the actual start command!
CMD ./examples/server/server -p 4433 -k key.pem -c cert.pem -A cacert.pem